/**
 * jtables - Create tables with JavaScript using JSON data
 * @version v0.1.0
 * @link 
 * @license MIT
 */

function jTablesFootBtnEvnt(t){$("#"+t.footbtn.prev).on("click",function(s){t.PageRev()}),$("#"+t.footbtn.next).on("click",function(s){t.PageNext()})}function jTablesFootRowsEvnt(t){$("#"+t.footrows.select.id).on("change",function(s){t.FootRowsChange()})}function jTablesClickRowsEvent(t,s,o){$("#"+t.cols.id+s+"_"+o).on("click",function(i){t.ClickRowsAction(s,o)})}function jTablesClickHeadEvent(t,s){$("#"+t.table.head+"_"+s).on("click",function(o){t.ClickHeadAction(s)})}function jTablesClickArrowEvent(t){$("#"+t.arrow.id).on("click",function(s){t.ClickArrowAction()})}var jTables=function(t){this.parent={},this.parent.id=t,this.parent["class"]="jtables",this.parent.closed="jtables-closed",this.head={},this.head.id=this.parent.id+"_head",this.head["class"]="jtables-head",this.body={},this.body.id=this.parent.id+"_body",this.body["class"]="jtables-body",this.body.show=!0,this.title={},this.title.id=this.head.id+"_title",this.title.text="Test table",this.title["class"]="jtables-title",this.arrow={},this.arrow.id=this.head.id+"_arrow",this.arrow["class"]="jtables-arrow",this.table={},this.table.id=this.parent.id+"_table",this.table.height=0,this.table["class"]="jtables-table",this.table.head=this.table.id+"_head",this.table.body=this.table.id+"_body",this.rows={},this.rows.id=this.parent.id+"_row_",this.rows.height=43,this.rows.num=5,this.rows.select=[5,10,20],this.data={},this.data.orig=[],this.data.procesed=null,this.sort={},this.sort.col=-1,this.sort.order=1,this.sort["class"]={},this.sort["class"]["default"]="jtables-sort",this.sort["class"].asc="jtables-sort-asc",this.sort["class"].des="jtables-sort-des",this.cols={},this.cols.id=this.parent.id+"_col_",this.cols.items=[],this.cols.num=0,this.callback=null,this.nodata={},this.nodata.id=this.parent.id+"_nodata",this.nodata["class"]="jtables-nodata",this.nodata.text="No data found",this.page={},this.page.now=0,this.page.num=0,this.foot={},this.foot.id=this.parent.id+"_foot",this.foot["class"]="jtables-foot",this.foottext={},this.foottext.page=this.foot.id+"_page",this.foottext.pagec="jtables-foot-text jtables-foot-text-page",this.foottext.total=this.foot.id+"_total",this.foottext.totalc="jtables-foot-text jtables-foot-text-total",this.foottext.totalt="Total of rows: ",this.footbtn={},this.footbtn["class"]="jtables-foot-btn",this.footbtn.next=this.foot.id+"_next",this.footbtn.prev=this.foot.id+"_prev",this.footrows={},this.footrows.id=this.foot.id+"_rows",this.footrows.show=!0,this.footrows.select={},this.footrows.select.id=this.footrows.id+"_select",this.footrows.select["class"]="jtables-foot-rows-select",this.footrows.text={},this.footrows.text.id=this.footrows.id+"_text",this.footrows.text["class"]="jtables-foot-rows-text",this.footrows.text.txt="Rows per page: "};jTables.prototype.Create=function(){return null===this.data.orig?(console.error("jTables: first add content before create the table."),!1):this.cols.items.length<1?(console.error("jTables: first add the columns before create the table."),!1):(this.data.procesed=this.data.orig,this.Build(),this.PagesInit(),this.Page(),this.FootEvnt(),this.FootShowTotal(),this.ClickArrowEvnt(),void this.ClickHeadEvnt())},jTables.prototype.Build=function(){var t="";t=t+'<div id="'+this.head.id+'" class="'+this.head["class"]+'">',t=t+'<div class="'+this.title["class"]+'">'+this.title.text+"</div>",t=t+'<div id="'+this.arrow.id+'" class="'+this.arrow["class"]+'"></div>',t+="</div>",t=t+'<div id="'+this.body.id+'" class="'+this.body["class"]+'">',t=t+'<div id="'+this.table.id+'">',t=t+'<table class="'+this.table["class"]+'">',t=t+'<thead id="'+this.table.head+'"><tr>';for(var s=0;s<this.cols.items.length;s++)t=t+'<td id="'+this.table.head+"_"+s+'" ',t=t+'class="'+this.sort["class"]["default"]+'" ',t+=">",t+=this.cols.items[s].label,t+="</td>";if(t+="</tr></thead>",t=t+'<tbody id="'+this.table.body+'"></tbody>',t+="</table>",t=t+'<div id="'+this.nodata.id+'" class="'+this.nodata["class"]+'">'+this.nodata.text+"</div>",t+="</div>",t=t+'<div id="'+this.foot.id+'" class="'+this.foot["class"]+'">',t=t+'<div id="'+this.footbtn.prev+'" class="'+this.footbtn["class"]+'">Prev</div>',t=t+'<div id="'+this.foottext.page+'" class="'+this.foottext.pagec+'"></div>',t=t+'<div id="'+this.footbtn.next+'" class="'+this.footbtn["class"]+'">Next</div>',this.footrows.show===!0){t=t+'<span class="'+this.footrows.text["class"]+'">'+this.footrows.text.txt+"</span>",t=t+'<select id="'+this.footrows.select.id+'" class="'+this.footrows.select["class"]+'">';for(var o=0;o<this.rows.select.length;o++)t=t+'<option value="'+this.rows.select[o]+'">'+this.rows.select[o]+"</option>";t+="</select>"}t=t+'<span id="'+this.foottext.total+'" class="'+this.foottext.totalc+'"></span>',t+="</div>",t+="</div>",$("#"+this.parent.id).html(t),$("#"+this.parent.id).addClass(this.parent["class"])},jTables.prototype.FootRowsChange=function(){this.rows.num=$("#"+this.footrows.select.id).val(),this.PagesInit(),this.Page()},jTables.prototype.FootShowPage=function(){var t=this.page.now+1;$("#"+this.foottext.page).text("Page "+t+" of "+this.page.num)},jTables.prototype.FootShowTotal=function(){$("#"+this.foottext.total).text(this.foottext.totalt+this.data.procesed.length)},jTables.prototype.FootEvnt=function(){jTablesFootBtnEvnt(this),jTablesFootRowsEvnt(this)},jTables.prototype.SortBy=function(t){$("#"+this.table.head+"_"+this.sort.col).removeClass(this.sort["class"].asc),$("#"+this.table.head+"_"+this.sort.col).removeClass(this.sort["class"].des),this.sort.col!=t?(this.sort.col=t,this.sort.order=1):this.sort.order=1==this.sort.order?-1:1,this.data.procesed=ObjectSort(this.data.orig,this.cols.items[this.sort.col].key),-1==this.sort.order?(this.data.procesed.reverse(),$("#"+this.table.head+"_"+this.sort.col).addClass(this.sort["class"].des)):$("#"+this.table.head+"_"+this.sort.col).addClass(this.sort["class"].asc),this.PagesInit(),this.Page()},jTables.prototype.PagesInit=function(){this.page.num=this.PagesCount(),this.page.now=0},jTables.prototype.PagesCount=function(){for(var t=0;t*this.rows.num<this.data.orig.length;)t+=1;return t},jTables.prototype.PageNext=function(){this.page.now=this.page.now+1,this.page.now>=this.page.num&&(this.page.now=this.page.now-1),this.Page()},jTables.prototype.PageRev=function(){this.page.now=this.page.now-1,this.page.now<0&&(this.page.now=0),this.Page()},jTables.prototype.Page=function(){for(var t="",s=Math.min(this.data.orig.length,this.rows.num*(this.page.now+1)),o=0,i=this.rows.num*this.page.now;s>i;i++){t=t+'<tr id="'+this.rows.id+o+'">';for(var e=0;e<this.cols.items.length;e++)t=t+'<td id="'+this.cols.id+o+"_"+e+'" ',t=t+'style="text-align:'+this.cols.items[e].align+'">',t=t+'<span style="'+this.cols.items[e].style+'">',t+=this.data.procesed[i][this.cols.items[e].key],t+="</span>",t+="</td>";t+="</tr>",o+=1}0==this.data.orig.length?$("#"+this.nodata.id).css("display","block"):$("#"+this.nodata.id).css("display","none"),$("#"+this.table.body).html(t),this.FootShowPage(),this.ClickRowsEvnt()},jTables.prototype.Callback=function(t){this.callback=t},jTables.prototype.DoCallback=function(t,s){var o=this.page.now*this.rows.num+t;console.log("jTables: Callback for index "+o),this.callback&&this.callback(this.data.procesed[o],this.cols.items[s].key)},jTables.prototype.ClickRowsEvnt=function(){for(var t=0;t<this.rows.num;t++)for(var s=0;s<this.cols.num;s++)jTablesClickRowsEvent(this,t,s)},jTables.prototype.ClickRowsAction=function(t,s){this.DoCallback(t,s)},jTables.prototype.ClickHeadEvnt=function(){for(var t=0;t<this.cols.items.length;t++)jTablesClickHeadEvent(this,t)},jTables.prototype.ClickHeadAction=function(t){this.SortBy(t)},jTables.prototype.ClickArrowEvnt=function(){jTablesClickArrowEvent(this)},jTables.prototype.ClickArrowAction=function(){this.body.show===!0?($("#"+this.parent.id).addClass(this.parent.closed),this.body.show=!1):($("#"+this.parent.id).removeClass(this.parent.closed),this.body.show=!0)},jTables.prototype.Title=function(t){this.title.text=t},jTables.prototype.AddColumn=function(t){"undefined"==typeof t.key||"undefined"==typeof t.label?console.error("jTables: undefined key or label for column"):("undefined"==typeof t.align&&(t.align="left"),"undefined"==typeof t.style&&(t.style=""),this.cols.items.push(t),this.cols.num=this.cols.num+1)},jTables.prototype.RowsPerPage=function(t){Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++)if(t[s]<1)return void console.log("jTables: please provide a number of rows per page > 0");this.rows.select=t,this.rows.num=t[0]},jTables.prototype.Content=function(t){this.data.orig=t};